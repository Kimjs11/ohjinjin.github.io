---
title: "Time-Series Analysis(1)"
categories: 
  - MachineLearning
last_modified_at: 2020-04-09T18:30:00+09:00
toc: true
---

Intro
---
학교 수강과목에서 학습한 내용을 복습하는 용도의 포스트입니다.<br/>

본 수업에서는 R 언어를 통해 1변량 시계열 데이터를 분석하고 ARIMA 등의 정상시계열 모형을 이용하여 예측하기까지의 실습 및 이론 수업으로 진행됩니다.<br/>

실습 환경 구축으로는 R 스튜디오 설치 정도가 있겠습니다.<br/>

[실습 과제 1 보러가기](https://github.com/ohjinjin/TimeSeries_Lab/blob/master/Lab1_convert_the_frequency.ipynb)<br/>

시계열(time series)
---
하나 또는 여러 사건(사상)에 대해 **시간의 흐름**에 따라 일정한 간격으로 이들을 관찰하여 기록한 자료를 말합니다.

어떤 경제 현상이나 자연 현상에 관한 시간적 변화를 나타내는 역사적 계열(historical series)

어느 한 시점 t에서 관측된 시계열 자료는 그 이전까지의 자료들에 주로 의존합니다.

그러나 그 이전까지의 여러 요인들의 (crisis 등)변화에도 영향이 존재하기 때문에 시계열의 법칙성을 발견해서 미래를 예측(classification 또는 regression)하는 것은 매우 복잡합니다.

수업에서는 시계열 데이터만의 규칙을 발견하고 이를 머신러닝 모델 또는 통계모형으로 이를 해결하는 과정을 다룹니다.

그러기 위해서는 패턴을 분석하는 것이 가장 먼저 할 일입니다.

그렇다면 시간의 흐름에 따라 불규칙적으로 변동되는 자료들도 분석이 가능할까요?

시계열 데이터에서는 변동 요인을 보통 4가지로 가정합니다.

변동요인
---
자료들의 특성을 단순화하는 것 입니다.

1. 추세변동(trend variation)
데이터를 보았을때 그 행보가 우상향으로 상승하는가, 하락하는가, 곡선추세인가 또는 횡보하는가 하는 변동

2. 계절변동(seasonal variation)
1년 안으로 반복적으로 나타나는 패턴들, 1년 동안의 월 또는 분기 등이 여기에 해당됩니다.
다음에 나오는 순환변동하고 구분할 수 있어야합니다.

3. 순환변동(cyclival variation)
계절변동과 비교했을때 보다 장기간의 term으로 반복되는 데이터를 말합니다. 
계절변동으로는 설명되지 않는 장기적인 주기변동으로 이해하시면됩니다.
보통 추세변동이랑 같이 분석되곤 합니다. 그래서 회복기, 번역기, 후퇴기, 침체기 네 단계로 구성됩니다.

4. 불규칙변동(irregular variation)
위 세가지 변동으로 설명하지 못하는 경우에 해당합니다.
사전적으로 예상할수 없는 특수한 사건에 의해 야기되는 변동이나 명확히 설명될 수 없는 요인에 의해 발생되는 우연변동입니다.

우리는 주어진 시계열데이터를 위 네가지 성분으로 나눠 설명할 수 있습니다.

여기에 통계모형(?)을 적용시키게 되는 것 입니다.

* 승법모형(multiplicative model) 
Zt = Tt*St*Ct*It
* 가법모형(additive model)
Zt = Tt+St+Ct+It

사실 우리가 머신러닝이나 통계모형 모델들 만으로는 완벽한 예측이 불가하죠, 이를 해소하는 것이 바로 **오차**입니다. 바로 장차값을 이용해 해결하는데 그것처럼 추세, 계절, 순환으로 설명할 수 없는 것에 대해 불규칙변동을 이용함으로써 해소합니다.




활용방법
---
지수(index number)
시계열 자료들의 변화동향을 비교하기 위해 특정한 시점을 기준으로 하여 백분비를 나타낸 값입니다.

지수 종류
1. 개별지수(individual index): 변수 하나의 계열을 비교하는 지수
2. 종합지수(composite index) : 여러 계열의 변화를 종합적으로 관찰하는 지수
ex) 단순지수

둘다 값은 하나인데, 여러가지의 값들을 포함시켜 결과값을 표현해낸게 종합지수라고 보면 됩니다.

단순지수
단순총합지수(simple aggregative index) : 기준시점에서의 
단순평균지수(simple :
dd
(이미지1)


개별지수 예제
2005년 서울 지역의 쌀의 도매가가 가마당 48000원, 2010년은 72000원일때 2005년 기준 2010년의 지수는?
100*72000/48000=150%
참고로 2005년의 지수는 100%입니다.

종합지수의 예인 단순지수 예제
아래는 어느 도시의 주요 식료품 소매가격에 대한 자료이다. 2005년을 기준으로한 각 연도별 단순총합지수와 2010년의 단순평균지수를 계산하시오.

이미지2
이미지3


시계열자료의 예측방법
---
(24페이지 뛰어넘음)

양적예측방법 구분
과거에는 데이터를 가장 잘나타내는 모형을 찾는 컨셉이었으나, 현재는 확률 통계를 기반으로 예측하도록 변해가는 추세입니다.
* 전통적 시계열분석방법 : 평활법(smotthing methods), 분해법(decomposition methods) 등
* 확률적 시계열분석방법
ML의 딥러닝, ML의 RNN, 시간영역분석(time domain analysis), ARIMA(autoregressive Integrated moving average), 주파수 영역분석인 퓨리에 분석(fourier analysis) 등

ARIMA에 0.4의 가중치를 두고 ML 모델에 0.6의 가중치를 둬서 섞어 쓰기도 합니다.

질적예측방법
---
저눈가의 견해를 기반으로 예측합니다.


예측의 평가
---
보통 ML 모델 구축시 데이터를 train:test를 6:4 내지는 7:3 정도로 나누죠

시계열에서도 비슷합니다.


예측 평가방법
관측가능기간동안에는 모형의 추정 및 사전평가(validation)를 진행하며, 예측기간에는 사후평가입니다.
모형의 추정및 사전평가를 나눠할 수도 있고 함께 진행할 수도 있습니다.

보통 ML에서는 일반 data에서 sampling을 하여 train데이터와 test를 구분하는데, time series는 어떨까요?
time series는 랜덤으로 sample을 뽑으면 안됩니다.
시간 순서가 중요하기 때문이죠.
대신 기간을 나눕니다.

순서가 꼬이면 미래의 데이터를 가지고 학습하는 셈이 되어버릴 수 있어서 유의해야합니다.

예측의 평가기준
평균제곱오차(Mean Squared Error, MSE)
평균제곱근 오차(,RMSE)(가장많이 사용)
평균절대오차(MeanAbsoluteError,MAE)
평균절대백분비오차(MAPercentageError)
타일의불일치개
(수정중)